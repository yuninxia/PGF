{
  "context": {
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <cuda_runtime.h>\n\n// CUDA kernel for matrix multiplication\n__global__ void matrixMulKernel(float *a, float *b, float *c, int N) {\n    int row = blockIdx.y * blockDim.y + threadIdx.y;\n    int col = blockIdx.x * blockDim.x + threadIdx.x;\n    float sum = 0.0f;\n\n    if (row < N && col < N) {\n        for (int k = 0; k < N; ++k) {\n            sum += a[row * N + k] * b[k * N + col];\n        }\n        c[row * N + col] = sum;\n    }\n}\n\nfloat launchAndTimeKernel(dim3 grid, dim3 block, float *A, float *B, float *C, int N)\n{\n    cudaEvent_t t0, t1;\n    cudaEventCreate(&t0);\n    cudaEventCreate(&t1);\n\n    cudaEventRecord(t0);\n    matrixMulKernel<<<grid, block>>>(A, B, C, N);\n    cudaEventRecord(t1);\n\n    // DON'T call cudaDeviceSynchronize(); events handle that.\n    cudaEventSynchronize(t1);\n\n    float ms = 0.f;\n    cudaEventElapsedTime(&ms, t0, t1);\n\n    cudaEventDestroy(t0);\n    cudaEventDestroy(t1);\n    return ms;                       // milliseconds of kernel *only*\n}\n\n// Helper function to print a matrix (for verification)\nvoid printMatrix(float *matrix, int N, const char* name) {\n    printf(\"Matrix %s:\\n\", name);\n    for (int i = 0; i < N; ++i) {\n        for (int j = 0; j < N; ++j) {\n            printf(\"%7.2f \", matrix[i * N + j]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n}\n\n// Helper function to initialize a matrix with random values\nvoid initializeMatrix(float *matrix, int N) {\n    for (int i = 0; i < N * N; ++i) {\n        matrix[i] = (float)rand() / RAND_MAX * 10.0f; // Random values between 0 and 10\n    }\n}\n\nint main() {\n    int N = 2048; // Matrix dimension (N x N)\n    int M_SIZE = N * N * sizeof(float); // Size of matrix in bytes\n\n    // Allocate host memory\n    float *h_a = (float *)malloc(M_SIZE);\n    float *h_b = (float *)malloc(M_SIZE);\n    float *h_c = (float *)malloc(M_SIZE); // Host result\n    float *h_c_gpu = (float *)malloc(M_SIZE); // Host copy of GPU result\n\n    if (h_a == NULL || h_b == NULL || h_c == NULL || h_c_gpu == NULL) {\n        fprintf(stderr, \"Failed to allocate host memory!\\n\");\n        return 1;\n    }\n\n    // Initialize host matrices\n    srand(0); // Seed for reproducibility\n    initializeMatrix(h_a, N);\n    initializeMatrix(h_b, N);\n\n    // Allocate device memory\n    float *d_a, *d_b, *d_c;\n    cudaError_t cudaStatus;\n\n    cudaStatus = cudaMalloc((void **)&d_a, M_SIZE);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMalloc failed for d_a!\\n\"); return 1; }\n    cudaStatus = cudaMalloc((void **)&d_b, M_SIZE);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMalloc failed for d_b!\\n\"); return 1; }\n    cudaStatus = cudaMalloc((void **)&d_c, M_SIZE);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMalloc failed for d_c!\\n\"); return 1; }\n\n    // Copy input matrices from host to device\n    cudaStatus = cudaMemcpy(d_a, h_a, M_SIZE, cudaMemcpyHostToDevice);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMemcpy H2D for d_a failed!\\n\"); return 1; }\n    cudaStatus = cudaMemcpy(d_b, h_b, M_SIZE, cudaMemcpyHostToDevice);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMemcpy H2D for d_b failed!\\n\"); return 1; }\n\n    // Define grid and block dimensions\n    dim3 threadsPerBlock(16, 16);\n    dim3 numBlocks((N + threadsPerBlock.x - 1) / threadsPerBlock.x,\n                   (N + threadsPerBlock.y - 1) / threadsPerBlock.y);\n\n    printf(\"Matrix multiplication %dx%d\\n\", N, N);\n    printf(\"Grid dimensions: (%d,%d), Block dimensions: (%d,%d)\\n\", \n           numBlocks.x, numBlocks.y, threadsPerBlock.x, threadsPerBlock.y);\n\n    // Warm-up runs\n    const int warmup_runs = 100;\n    printf(\"\\nPerforming %d warm-up runs...\\n\", warmup_runs);\n    for (int i = 0; i < warmup_runs; ++i) {\n        launchAndTimeKernel(numBlocks, threadsPerBlock, d_a, d_b, d_c, N);\n    }\n    cudaDeviceSynchronize();\n\n    // Benchmark runs\n    const int benchmark_runs = 100;\n    float total_time = 0.0f;\n    float min_time = 1e10;\n    float max_time = 0.0f;\n    \n    printf(\"\\nPerforming %d benchmark runs...\\n\", benchmark_runs);\n    for (int i = 0; i < benchmark_runs; ++i) {\n        float ms = launchAndTimeKernel(numBlocks, threadsPerBlock, d_a, d_b, d_c, N);\n        total_time += ms;\n        min_time = min(min_time, ms);\n        max_time = max(max_time, ms);\n        // if ((i + 1) % 10 == 0) {\n        //     printf(\"Completed %d runs...\\n\", i + 1);\n        // }\n    }\n\n    // Calculate statistics\n    float avg_time = total_time / benchmark_runs;\n    printf(\"\\nBenchmark Results:\\n\");\n    printf(\"Average time: %.3f ms\\n\", avg_time);\n    printf(\"Min time:     %.3f ms\\n\", min_time);\n    printf(\"Max time:     %.3f ms\\n\", max_time);\n    printf(\"Total runs:   %d\\n\", benchmark_runs);\n\n    // Check for kernel launch errors\n    cudaStatus = cudaGetLastError();\n    if (cudaStatus != cudaSuccess) {\n        fprintf(stderr, \"Kernel launch failed: %s\\n\", cudaGetErrorString(cudaStatus));\n        return 1;\n    }\n\n    // Copy result matrix from device to host\n    cudaStatus = cudaMemcpy(h_c_gpu, d_c, M_SIZE, cudaMemcpyDeviceToHost);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMemcpy D2H for d_c failed!\\n\"); return 1; }\n\n    printf(\"\\nGPU computation complete.\\n\");\n\n    // Free device memory\n    cudaFree(d_a);\n    cudaFree(d_b);\n    cudaFree(d_c);\n\n    // Free host memory\n    free(h_a);\n    free(h_b);\n    free(h_c);\n    free(h_c_gpu);\n\n    return 0;\n} ",
    "hpctoolkit_profiling_database": "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Scope                                                                                                    File  line  GINS: Sum (I)  GINS: Sum (I) %  GINS:STL_ANY: Sum (I)  GINS:STL_ANY: Sum (I) %  GINS:STL_IFET: Sum (I)  GINS:STL_IFET: Sum (I) %  GINS:STL_IDEP: Sum (I)  GINS:STL_IDEP: Sum (I) %  GINS:STL_GMEM: Sum (I)  GINS:STL_GMEM: Sum (I) % GINS:STL_CMEM: Sum (I)  GINS:STL_CMEM: Sum (I) % GINS:STL_PIPE: Sum (I)  GINS:STL_PIPE: Sum (I) % GINS:STL_MTHR: Sum (I)  GINS:STL_MTHR: Sum (I) %\n0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <program root>                                                                                                          <NA>      3.297e+11          100.000              1.763e+11                  100.000               3.045e+08                   100.000               7.827e+09                 1.000e+02               5.107e+10                   100.000                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <program root> \u00bb main                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    59      3.297e+11          100.000              1.763e+11                  100.000               3.045e+08                   100.000               7.827e+09                 1.000e+02               5.107e+10                   100.000                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n24                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu   108      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n25                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu   109      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n26                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    20      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n27                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    26      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n28                                                                                                                                                                                                                                                                                                                                                                                                                                                               <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n29                                                                                                                                                                                                                                                                                                                                                                                         <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n30                                                                                                                                                                                                                                                                                                                                              <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i                                               /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c    13      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n31                                                                                                                                                                                                                                                                               <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13                                               /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c    13      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n32                                                                                                                                                                                                                                                            <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel  src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h   216      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n33                                                                                                                                               <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216  src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h   216      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n34                                                                                                                            <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel                                                                                                [matmul]     0      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n35                                                                                                          <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line)                                                                                                [matmul]     0      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n36                                                                                           <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel>                                                                                                             0      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n37                                                                         <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.654e+11           50.152              8.869e+10                   50.295               1.525e+08                    50.089               3.917e+09                 5.004e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n41  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:11                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    11      1.995e+07            0.006              9.888e+06                    0.006               9.830e+04                     0.032               3.834e+06                 4.898e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n42  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:12                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    12      1.139e+09            0.345              2.035e+08                    0.115               2.933e+06                     0.963               1.955e+08                 2.497e+00                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n43  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:13                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    13      1.641e+11           49.766              8.842e+10                   50.140               1.445e+08                    47.455               3.698e+09                 4.724e+01               2.613e+10                    51.159                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n38  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:15                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    15      1.285e+07            0.004              4.858e+06                    0.003               1.294e+06                     0.425               2.212e+06                 2.826e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n45  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:17                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    17      4.022e+07            0.012              2.427e+07                    0.014               2.302e+06                     0.756               1.409e+06                 1.800e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n44   <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.095e+07            0.003              6.562e+06                    0.004               1.311e+06                     0.430               3.277e+04                 4.186e-04                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n39   <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:7                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     7      2.503e+07            0.008              1.103e+07                    0.006               8.192e+04                     0.027               6.463e+06                 8.258e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n40   <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:108 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:109 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_150 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:8                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     8      2.368e+07            0.007              1.262e+07                    0.007                     NaN                       NaN               1.008e+07                 1.288e-01                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu   120      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu   121      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    20      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    26      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n6                                                                                                                                                                                                                                                                                                                                                                                                                                                                <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n7                                                                                                                                                                                                                                                                                                                                                                                          <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n8                                                                                                                                                                                                                                                                                                                                               <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i                                               /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c    13      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n9                                                                                                                                                                                                                                                                                <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13                                               /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c    13      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n10                                                                                                                                                                                                                                                            <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel  src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h   216      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n11                                                                                                                                               <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216  src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h   216      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n12                                                                                                                            <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel                                                                                                [matmul]     0      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n13                                                                                                          <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line)                                                                                                [matmul]     0      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n14                                                                                           <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel>                                                                                                             0      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n15                                                                         <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.644e+11           49.848              8.765e+10                   49.705               1.520e+08                    49.911               3.910e+09                 4.996e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n20  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:11                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    11      2.046e+07            0.006              1.020e+07                    0.006               1.147e+05                     0.038               3.621e+06                 4.626e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n21  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:12                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    12      1.138e+09            0.345              2.039e+08                    0.116               2.777e+06                     0.912               1.957e+08                 2.501e+00                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n22  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:13                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    13      1.631e+11           49.462              8.738e+10                   49.550               1.443e+08                    47.375               3.692e+09                 4.716e+01               2.494e+10                    48.841                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n23  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:15                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    15      1.209e+07            0.004              4.702e+06                    0.003               1.090e+06                     0.358               2.138e+06                 2.732e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n17  <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:17                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu    17      3.937e+07            0.012              2.317e+07                    0.013               2.204e+06                     0.724               1.090e+06                 1.392e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n16   <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     6      1.425e+07            0.004              8.331e+06                    0.005               1.466e+06                     0.481               3.277e+04                 4.186e-04                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n18   <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:7                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     7      2.523e+07            0.008              1.119e+07                    0.006               7.373e+04                     0.024               6.283e+06                 8.027e-02                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n19   <program root> \u00bb main \u00bb loop at src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:120 \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:121 \u00bb launchAndTimeKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:26 \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:6 \u00bb __device_stub__Z15matrixMulKernelPfS_S_i \u00bb /tmp/tmpxft_000e69ae_00000000-6_matrix_mul.cudafe1.stub.c:13 \u00bb cudaLaunchKernel \u00bb src/scratch/opt/nvidia/hpc_sdk/Linux_x86_64/23.9/cuda/12.2/targets/x86_64-linux/include/cuda_runtime.h:216 \u00bb cudaLaunchKernel \u00bb Node_298 (line) \u00bb <gpu kernel> \u00bb matrixMulKernel \u00bb src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu:8                                       src/home/yx87/pg/ft-codellama-sample-hpctoolkit/src/matrix_mul.cu     8      2.399e+07            0.007              1.205e+07                    0.007                     NaN                       NaN               9.757e+06                 1.247e-01                     NaN                       NaN                   <NA>                       0.0                   <NA>                       0.0                   <NA>                       0.0\n"
  },
  "response": {
    "optimization_suggestions": "1 Register blocking + multiple accumulators\nWhy? The single running sum in your loop forms a strict read-after-write chain, so every FMA must wait for the previous one to finish.\nFix: keep 2-8 independent partial sums in registers and combine them once per tile. This shortens each dependency chain by that factor and exposes instruction-level parallelism (ILP) to the scheduler.\n\n2 Loop unrolling\nPair the extra accumulators with an explicit #pragma unroll (or manual unroll) so the compiler issues several FMAs back-to-back without branch overhead.\n\n3 Tiling into shared memory\nBringing a block-sized \u201ctile\u201d of A and B into __shared__ memory lets every thread reuse the operands held in L1/L0, cuts global-memory traffic, and ensures coalesced loads. You also hide memory latency that could otherwise overlap with the arithmetic ILP you just exposed.\n",
    "optimized_code": "#include <stdio.h>\n#include <stdlib.h>\n#include <cuda_runtime.h>\n\n// tile size (16\u00d716 is fine on nearly every architecture)\n#ifndef TILE\n#define TILE 16\n#endif\n\n__global__ void matrixMulKernelOpt(const float *__restrict__ A,\n                                   const float *__restrict__ B,\n                                   float       *__restrict__ C,\n                                   int N)\n{\n    __shared__ float As[TILE][TILE];\n    __shared__ float Bs[TILE][TILE];\n\n    int row = blockIdx.y * TILE + threadIdx.y;\n    int col = blockIdx.x * TILE + threadIdx.x;\n\n    // Four independent accumulators \u2193\u2193\u2193 to shorten the dependency chain\n    float sum0 = 0.f, sum1 = 0.f, sum2 = 0.f, sum3 = 0.f;\n\n    // Walk across the K dimension one TILE at a time\n    for (int t = 0; t < N; t += TILE) {\n        // Cooperative load of one tile of A and B into shared memory\n        As[threadIdx.y][threadIdx.x] = (row < N && t + threadIdx.x < N)\n                                         ? A[row * N + (t + threadIdx.x)]\n                                         : 0.f;\n\n        Bs[threadIdx.y][threadIdx.x] = (col < N && t + threadIdx.y < N)\n                                         ? B[(t + threadIdx.y) * N + col]\n                                         : 0.f;\n        __syncthreads();\n\n        // --- HOT inner loop, completely unrolled ---\n        #pragma unroll       // lets the compiler schedule FMAs aggressively\n        for (int k = 0; k < TILE; k += 4) {\n            // Load 4 pairs of operands\n            float a0 = As[threadIdx.y][k + 0];\n            float a1 = As[threadIdx.y][k + 1];\n            float a2 = As[threadIdx.y][k + 2];\n            float a3 = As[threadIdx.y][k + 3];\n\n            float b0 = Bs[k + 0][threadIdx.x];\n            float b1 = Bs[k + 1][threadIdx.x];\n            float b2 = Bs[k + 2][threadIdx.x];\n            float b3 = Bs[k + 3][threadIdx.x];\n\n            // Four independent FMAs (\u2192 \u00bc dependency depth)\n            sum0 = fmaf(a0, b0, sum0);\n            sum1 = fmaf(a1, b1, sum1);\n            sum2 = fmaf(a2, b2, sum2);\n            sum3 = fmaf(a3, b3, sum3);\n        }\n        __syncthreads();\n    }\n\n    if (row < N && col < N) {\n        C[row * N + col] = sum0 + sum1 + sum2 + sum3;  // final reduction\n    }\n}\n\nfloat launchAndTimeKernel(dim3 grid, dim3 block, float *A, float *B, float *C, int N)\n{\n    cudaEvent_t t0, t1;\n    cudaEventCreate(&t0);\n    cudaEventCreate(&t1);\n\n    cudaEventRecord(t0);\n    matrixMulKernelOpt<<<grid, block>>>(A, B, C, N);\n    cudaEventRecord(t1);\n\n    // DON'T call cudaDeviceSynchronize(); events handle that.\n    cudaEventSynchronize(t1);\n\n    float ms = 0.f;\n    cudaEventElapsedTime(&ms, t0, t1);\n\n    cudaEventDestroy(t0);\n    cudaEventDestroy(t1);\n    return ms;                       // milliseconds of kernel *only*\n}\n\n// Helper function to print a matrix (for verification)\nvoid printMatrix(float *matrix, int N, const char* name) {\n    printf(\"Matrix %s:\\n\", name);\n    for (int i = 0; i < N; ++i) {\n        for (int j = 0; j < N; ++j) {\n            printf(\"%7.2f \", matrix[i * N + j]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n}\n\n// Helper function to initialize a matrix with random values\nvoid initializeMatrix(float *matrix, int N) {\n    for (int i = 0; i < N * N; ++i) {\n        matrix[i] = (float)rand() / RAND_MAX * 10.0f; // Random values between 0 and 10\n    }\n}\n\nint main() {\n    int N = 2048; // Matrix dimension (N x N)\n    int M_SIZE = N * N * sizeof(float); // Size of matrix in bytes\n\n    // Allocate host memory\n    float *h_a = (float *)malloc(M_SIZE);\n    float *h_b = (float *)malloc(M_SIZE);\n    float *h_c = (float *)malloc(M_SIZE); // Host result\n    float *h_c_gpu = (float *)malloc(M_SIZE); // Host copy of GPU result\n\n    if (h_a == NULL || h_b == NULL || h_c == NULL || h_c_gpu == NULL) {\n        fprintf(stderr, \"Failed to allocate host memory!\\n\");\n        return 1;\n    }\n\n    // Initialize host matrices\n    srand(0); // Seed for reproducibility\n    initializeMatrix(h_a, N);\n    initializeMatrix(h_b, N);\n\n    // Allocate device memory\n    float *d_a, *d_b, *d_c;\n    cudaError_t cudaStatus;\n\n    cudaStatus = cudaMalloc((void **)&d_a, M_SIZE);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMalloc failed for d_a!\\n\"); return 1; }\n    cudaStatus = cudaMalloc((void **)&d_b, M_SIZE);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMalloc failed for d_b!\\n\"); return 1; }\n    cudaStatus = cudaMalloc((void **)&d_c, M_SIZE);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMalloc failed for d_c!\\n\"); return 1; }\n\n    // Copy input matrices from host to device\n    cudaStatus = cudaMemcpy(d_a, h_a, M_SIZE, cudaMemcpyHostToDevice);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMemcpy H2D for d_a failed!\\n\"); return 1; }\n    cudaStatus = cudaMemcpy(d_b, h_b, M_SIZE, cudaMemcpyHostToDevice);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMemcpy H2D for d_b failed!\\n\"); return 1; }\n\n    // Define grid and block dimensions\n    dim3 threadsPerBlock(TILE, TILE);  // Using TILE constant for consistency\n    dim3 numBlocks((N + threadsPerBlock.x - 1) / threadsPerBlock.x,\n                   (N + threadsPerBlock.y - 1) / threadsPerBlock.y);\n\n    printf(\"Matrix multiplication (Optimized) %dx%d\\n\", N, N);\n    printf(\"Grid dimensions: (%d,%d), Block dimensions: (%d,%d)\\n\", \n           numBlocks.x, numBlocks.y, threadsPerBlock.x, threadsPerBlock.y);\n\n    // Warm-up runs\n    const int warmup_runs = 100;\n    printf(\"\\nPerforming %d warm-up runs...\\n\", warmup_runs);\n    for (int i = 0; i < warmup_runs; ++i) {\n        launchAndTimeKernel(numBlocks, threadsPerBlock, d_a, d_b, d_c, N);\n    }\n    cudaDeviceSynchronize();\n\n    // Benchmark runs\n    const int benchmark_runs = 100;\n    float total_time = 0.0f;\n    float min_time = 1e10;\n    float max_time = 0.0f;\n    \n    printf(\"\\nPerforming %d benchmark runs...\\n\", benchmark_runs);\n    for (int i = 0; i < benchmark_runs; ++i) {\n        float ms = launchAndTimeKernel(numBlocks, threadsPerBlock, d_a, d_b, d_c, N);\n        total_time += ms;\n        min_time = min(min_time, ms);\n        max_time = max(max_time, ms);\n        // if ((i + 1) % 10 == 0) {\n        //     printf(\"Completed %d runs...\\n\", i + 1);\n        // }\n    }\n\n    // Calculate statistics\n    float avg_time = total_time / benchmark_runs;\n    printf(\"\\nBenchmark Results:\\n\");\n    printf(\"Average time: %.3f ms\\n\", avg_time);\n    printf(\"Min time:     %.3f ms\\n\", min_time);\n    printf(\"Max time:     %.3f ms\\n\", max_time);\n    printf(\"Total runs:   %d\\n\", benchmark_runs);\n\n    // Check for kernel launch errors\n    cudaStatus = cudaGetLastError();\n    if (cudaStatus != cudaSuccess) {\n        fprintf(stderr, \"Kernel launch failed: %s\\n\", cudaGetErrorString(cudaStatus));\n        return 1;\n    }\n\n    // Copy result matrix from device to host\n    cudaStatus = cudaMemcpy(h_c_gpu, d_c, M_SIZE, cudaMemcpyDeviceToHost);\n    if (cudaStatus != cudaSuccess) { fprintf(stderr, \"cudaMemcpy D2H for d_c failed!\\n\"); return 1; }\n\n    printf(\"\\nGPU computation complete.\\n\");\n\n    // Free device memory\n    cudaFree(d_a);\n    cudaFree(d_b);\n    cudaFree(d_c);\n\n    // Free host memory\n    free(h_a);\n    free(h_b);\n    free(h_c);\n    free(h_c_gpu);\n\n    return 0;\n} "
  }
}